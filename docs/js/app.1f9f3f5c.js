(function(e){function n(n){for(var r,o,s=n[0],c=n[1],l=n[2],d=0,f=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&f.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);u&&u(n);while(f.length)f.shift()();return i.push.apply(i,l||[]),t()}function t(){for(var e,n=0;n<i.length;n++){for(var t=i[n],r=!0,s=1;s<t.length;s++){var c=t[s];0!==a[c]&&(r=!1)}r&&(i.splice(n--,1),e=o(o.s=t[0]))}return e}var r={},a={app:0},i=[];function o(n){if(r[n])return r[n].exports;var t=r[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=e,o.c=r,o.d=function(e,n,t){o.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,n){if(1&n&&(e=o(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)o.d(t,r,function(n){return e[n]}.bind(null,r));return t},o.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(n,"a",n),n},o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=n,s=s.slice();for(var l=0;l<s.length;l++)n(s[l]);var u=c;i.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("56d7")},"0ab4":function(e,n,t){"use strict";var r=t("5b3a"),a=t.n(r);a.a},"399b":function(e,n,t){},"53f6":function(e,n,t){"use strict";var r=t("399b"),a=t.n(r);a.a},"56d7":function(e,n,t){"use strict";t.r(n);t("cadf"),t("551c"),t("f751"),t("097d"),t("6d93");var r=t("2b0e"),a=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{attrs:{id:"app"}},[t("BRSUI")],1)},i=[],o=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"brs-container"},[t("BRSViewer",{attrs:{brsBuff:e.brsBuff}}),t("div",{staticClass:"brs-main",class:{"keep-open":e.interacting},on:{mouseenter:function(n){e.interacting=!0},mouseleave:e.stopInteracting}},[t("div",{staticClass:"brs-header"},[t("h2",[e._v("BRS.world")]),t("p",[e._v("View and share your Brickadia builds")]),t("button",{on:{click:e.openFileUploader}},[e._v("Open .brs")]),e.file?t("p",[e._v("\n        "+e._s(e.file.name)+e._s(e.file.size)+"\n        "),t("button",{on:{click:e.uploadFile}},[e._v("Upload")])]):e._e(),t("input",{ref:"fileUpload",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:function(n){return e.onFileChange(n)}}})]),t("div",{staticClass:"brs-list"},e._l(e.brsInfoWState,(function(n){return t("div",{key:n.url,staticClass:"brs-list-item",class:{selected:n.selected},on:{click:function(t){return e.onEntryClick(t,n)}}},[t("h2",[e._v(e._s(n.map))]),t("p",[e._v(e._s(n.author.name))]),e._e()])})),0)])],1)},s=[],c=(t("8e6e"),t("456d"),t("ac6a"),t("96cf"),t("3b8d")),l=t("bd86");function u(e){return Object.keys(e).forEach((function(n){Object.defineProperty(e,n,{configurable:!1})})),e}var d=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("canvas",{ref:"renderer"},[e._v("No WebGL Boi")])},f=[],p=t("75fc"),m=t("5a89"),h=(t("4721"),t("63d9"),t("768b")),b=t("d225"),g=t("308d"),v=t("6bb5"),_=t("b0b4"),w=t("4e2b"),y=(t("7353"),function(e){function n(){return Object(b["a"])(this,n),Object(g["a"])(this,Object(v["a"])(n).apply(this,arguments))}return Object(w["a"])(n,e),Object(_["a"])(n,[{key:"onBeforeCompile",value:function(e,n){e.vertexShader="\n#define STANDARD\n#define USE_UV\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n  varying vec3 vNormal;\n  #ifdef USE_TANGENT\n    varying vec3 vTangent;\n    varying vec3 vBitangent;\n  #endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\n// === INSTANCED ===\nvec3 applyTRS( vec3 position, vec3 translation, vec4 quaternion, vec3 scale ) {\n  position *= scale;\n  position += 2.0 * cross( quaternion.xyz, cross( quaternion.xyz, position ) + quaternion.w * position );\n  return position + translation;\n}\nattribute vec3 instancePosition;\nattribute vec4 instanceQuaternion;\nattribute vec3 instanceScale;\nattribute vec3 instanceColor;\n\nvoid main() {\n  #include <uv_vertex>\n  vUv *= vec2(10.0, 10.0);\n  #include <uv2_vertex>\n  #include <color_vertex>\n  // === INSTANCED (color) ===\n  #ifdef USE_COLOR\n    vColor.xyz = instanceColor.xyz;\n  #endif\n  #include <beginnormal_vertex>\n  #include <morphnormal_vertex>\n  #include <skinbase_vertex>\n  #include <skinnormal_vertex>\n  #include <defaultnormal_vertex>\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n  vNormal = normalize( transformedNormal );\n  #ifdef USE_TANGENT\n    vTangent = normalize( transformedTangent );\n    vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n  #endif\n#endif\n  #include <begin_vertex>\n  // === INSTANCED (position) ===\n  transformed = applyTRS( transformed, instancePosition, instanceQuaternion, instanceScale );\n\n  #include <morphtarget_vertex>\n  #include <skinning_vertex>\n  #include <displacementmap_vertex>\n  #include <project_vertex>\n  #include <logdepthbuf_vertex>\n  #include <clipping_planes_vertex>\n  vViewPosition = - mvPosition.xyz;\n  #include <worldpos_vertex>\n  #include <shadowmap_vertex>\n  #include <fog_vertex>\n  //vColor = instanceColor;//color;\n}\n        ",e.fragmentShader="\n#define STANDARD\n#ifdef PHYSICAL\n  #define REFLECTIVITY\n  #define CLEARCOAT\n  #define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n  uniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n  uniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n  uniform float clearcoat;\n  uniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n  uniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n  varying vec3 vNormal;\n  #ifdef USE_TANGENT\n    varying vec3 vTangent;\n    varying vec3 vBitangent;\n  #endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\n// === MINE ===\n//varying vec3 vColor;\n\nvoid main() {\n  #include <clipping_planes_fragment>\n  vec4 diffuseColor = vec4( diffuse, opacity );\n  ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n  vec3 totalEmissiveRadiance = emissive;\n  #include <logdepthbuf_fragment>\n  #include <map_fragment>\n  #include <color_fragment>\n  //diffuseColor.rgb = vColor;\n  #include <alphamap_fragment>\n  #include <alphatest_fragment>\n  #include <roughnessmap_fragment>\n  #include <metalnessmap_fragment>\n  #include <normal_fragment_begin>\n\n  #include <normal_fragment_maps>\n  #include <clearcoat_normal_fragment_begin>\n  #include <clearcoat_normal_fragment_maps>\n  #include <emissivemap_fragment>\n  // accumulation\n  #include <lights_physical_fragment>\n  #include <lights_fragment_begin>\n  #include <lights_fragment_maps>\n  #include <lights_fragment_end>\n  // modulation\n  #include <aomap_fragment>\n  vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n  // this is a stub for the transparency model\n  #ifdef TRANSPARENCY\n    diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n  #endif\n  gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n  #include <tonemapping_fragment>\n  #include <encodings_fragment>\n  #include <fog_fragment>\n  #include <premultiplied_alpha_fragment>\n  #include <dithering_fragment>\n}\n        "}}]),n}(m["MeshStandardMaterial"])),x=function(e){function n(e){var t;Object(b["a"])(this,n);var r=n._buildResources(e),a=Object(h["a"])(r,2),i=a[0],o=a[1];return t=Object(g["a"])(this,Object(v["a"])(n).call(this,i,o)),t.brs=e,t}return Object(w["a"])(n,e),Object(_["a"])(n,null,[{key:"brickWidth",value:function(){return 10}}]),Object(_["a"])(n,null,[{key:"fromBuffer",value:function(e){console.log("Start parse...");var t=BRS.read(e);return new n(t)}},{key:"_buildResources",value:function(e){var t=new m["BoxBufferGeometry"](1,1,1);t.attributes.uv.array=t.attributes.uv.array.map((function(e){return e/n.brickWidth()}));new m["Color"](1,1,1),new m["BufferGeometry"];var r=[],a=[],i=[],o=[];console.log("Starting load..."),e.bricks.forEach((function(n,t){if(t%1e3===0&&console.log("Brick ".concat(t)),n.visibility){var s=new m["Vector3"](n.position[0],n.position[2],n.position[1]),c=[new m["Vector3"](1,0,0),new m["Vector3"](-1,0,0),new m["Vector3"](0,0,1),new m["Vector3"](0,0,-1),new m["Vector3"](0,1,0),new m["Vector3"](0,-1,0)],l=[0,Math.PI/2,Math.PI,3*Math.PI/2],u=(new m["Quaternion"]).setFromAxisAngle(c[n.direction],l[n.rotation]),d=new m["Vector3"](2*n.size[0],2*n.size[2],2*n.size[1]),f=Array.isArray(n.color)?new m["Color"](n.color[0]/255,n.color[1]/255,n.color[2]/255):e.colors[n.color];r.push(s.x,s.y,s.z),a.push(u.x,u.y,u.z,u.w),i.push(d.x,d.y,d.z),o.push(f[0]/255,f[1]/255,f[2]/255)}}));var s=new m["InstancedBufferGeometry"];s.index=t.index,s.attributes.position=t.attributes.position,s.addAttribute("instancePosition",new m["InstancedBufferAttribute"](new Float32Array(r),3)),s.addAttribute("instanceQuaternion",new m["InstancedBufferAttribute"](new Float32Array(a),4)),s.addAttribute("instanceScale",new m["InstancedBufferAttribute"](new Float32Array(i),3)),s.addAttribute("instanceColor",new m["InstancedBufferAttribute"](new Float32Array(o),3));var c=new y({vertexColors:m["VertexColors"],flatShading:!0,map:void 0});return(new m["TextureLoader"]).load("brickTOP.png",(function(e){e.wrapS=m["RepeatWrapping"],e.wrapT=m["RepeatWrapping"]})),[s,c]}}]),n}(m["Mesh"]),S=function(e){function n(){var e;Object(b["a"])(this,n),e=Object(g["a"])(this,Object(v["a"])(n).call(this));var t=new m["AmbientLight"](12303291);e.add(t);var r=new m["DirectionalLight"](16777215);r.position.set(20,30,-5),r.target.position.set(0,0,0),r.castShadow=!0,r.shadow.camera.left=-30,r.shadow.camera.top=-30,r.shadow.camera.right=30,r.shadow.camera.bottom=30,r.shadow.camera.near=20,r.shadow.camera.far=200,r.shadow.bias=-.001,r.shadow.mapSize.width=r.shadow.mapSize.height=2048,e.add(r);var a=new m["PointLight"](16777181,2,2);a.position.set(0,3,-2),e.add(a),(new m["TextureLoader"]).load("brickgreen.png",(function(e){e.wrapS=m["RepeatWrapping"],e.wrapT=m["RepeatWrapping"],i.map=e}));var i=new m["MeshStandardMaterial"]({color:43520,map:void 0}),o=1e5,s=new m["Mesh"](new m["PlaneBufferGeometry"](o,o),i),c=s.geometry.getAttribute("uv");return console.log(c),c.array=c.array.map((function(e){return e*o/x.brickWidth()})),c.needsUpdate=!0,s.quaternion.setFromAxisAngle(new m["Vector3"](1,0,0),-Math.PI/2),s.frustumCulled=!1,e.add(s),e.fog=new m["FogExp2"](10066431,25e-6),e}return Object(w["a"])(n,e),n}(m["Scene"]),C={name:"BRSViewer",props:{brsBuff:ArrayBuffer},data:function(){return{renderer:void 0,scene:u(new S),cam:u(new m["PerspectiveCamera"](75,1,1,8e4)),buildBounds:void 0,rafID:void 0}},mounted:function(){this.renderer=u(new m["WebGLRenderer"]({canvas:this.$refs.renderer,antialias:!0,logarithmicDepthBuffer:!0})),this.renderer.setClearColor(new m["Color"](10066431));var e=this.$refs.renderer.getBoundingClientRect();this.renderer.setSize(e.width,e.height),this.cam.position.set(0,10,0)},watch:{brsBuff:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var n,t,r,a,i,o,s,c,l,d=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.brsBuff){e.next=2;break}return e.abrupt("return");case 2:window.cancelAnimationFrame(this.rafID),(n=this.scene).remove.apply(n,Object(p["a"])(this.scene.children.filter((function(e){return e instanceof x})))),t=x.fromBuffer(this.brsBuff),t.frustumCulled=!1,this.scene.add(t),r=t.brs.bricks.map((function(e){if(e.visibility)return new m["Vector3"](e.position[0],e.position[2],e.position[1])})).filter((function(e){return!!e})),a=r.reduce((function(e,n){return e.add(n)}),new m["Vector3"](0,0,0)).multiplyScalar(1/r.length),i=r.map((function(e){return e.distanceTo(a)})),o=i.reduce((function(e,n){return e+n}),0)/r.length,s=i.reduce((function(e,n){return e+Math.pow(Math.abs(n-o),2)}),0),c=Math.sqrt(s/r.length),l=0,this.buildBounds=u(new m["Box3"]),t.brs.bricks.forEach((function(e){var n=new m["Vector3"](e.position[0],e.position[2],e.position[1]).distanceTo(a);if(n>o+3*c||n<o-3*c)return console.log("Removed outlier at Brickadia position ".concat(e.position," ").concat(n)),void l++;d.buildBounds.expandByPoint(new m["Vector3"](e.position[0],e.position[2],e.position[1]))})),console.log("Center: ".concat(a.x," ").concat(a.y," ").concat(a.z)),console.log("Mean: ".concat(o)),console.log("StdD: ".concat(c)),console.log("Outl: ".concat(l)),console.log("BrickCount: ".concat(r.length)),console.log(this.buildBounds),this.rafID=window.requestAnimationFrame(this.render.bind(this));case 23:case"end":return e.stop()}}),e,this)})));function n(){return e.apply(this,arguments)}return n}()},methods:{render:function(){this.rafID=window.requestAnimationFrame(this.render.bind(this));var e=Date.now()/1e3/30*Math.PI*2,n=Math.sin(e),t=Math.cos(e),r=this.buildBounds.getCenter(new m["Vector3"]),a=this.buildBounds.getSize(new m["Vector3"]).multiplyScalar(.5);this.cam.position.copy(r),this.cam.position.add(new m["Vector3"](1.5*a.x*n,2*a.y,1.5*a.z*t)),this.cam.lookAt(r.clone().add(new m["Vector3"](a.x*n,0,a.z*t))),this.renderer.render(this.scene,this.cam)}}},A=C,O=(t("53f6"),t("2877")),B=Object(O["a"])(A,d,f,!1,null,null,null),T=B.exports;function R(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function j(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?R(t,!0).forEach((function(n){Object(l["a"])(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):R(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var k={name:"BRSUI",components:{BRSViewer:T},data:function(){return{brsBuff:void 0,interacting:!1,uploadFile:void 0,brsInfoList:[{map:"Bowling Alley",author:{id:"xxx",name:"Cobertos"},description:"Bowling alley I made a long time back but it held up pretty well",url:"https://s3.us-east-2.amazonaws.com/cobstatic.com/brs.world/builds/BowlingAlleyUpdatev0.3.brs"},{map:"Valley TDM",author:{id:"xxx",name:"Cobertos"},description:"A large TDM set in a valley with may interactable elements and easter eggs",url:"https://s3.us-east-2.amazonaws.com/cobstatic.com/brs.world/builds/ValleyTDMFINALFINAL1.brs"},{map:"Balloonist's Build Royale",author:{id:"xxx",name:"Cobertos"},description:"Islands featured in the Blockland trailer for an unfinished gamemode",url:"https://s3.us-east-2.amazonaws.com/cobstatic.com/brs.world/builds/BBRMinimal8.brs"},{map:"de_cbble2",author:{id:"xxx",name:"Cobertos"},description:"Half of de_cbble2 from Counter Strike 1.6",url:"https://s3.us-east-2.amazonaws.com/cobstatic.com/brs.world/builds/de_cbble2.brs"},{map:"Escher",author:{id:"xxx",name:"Cobertos"},description:"Escher-esque staircases",url:"https://s3.us-east-2.amazonaws.com/cobstatic.com/brs.world/builds/escher4.brs"},{map:"Feel Good Inc Island",author:{id:"xxx",name:"Cobertos"},description:"The floating windmill island from the Gorillaz song Feel Good Inc",url:"https://s3.us-east-2.amazonaws.com/cobstatic.com/brs.world/builds/FloatingIslandFINAL.brs"},{map:"Modern House",author:{id:"xxx",name:"Cobertos"},description:"A modern house with some secret bat cave like thing.",url:"https://s3.us-east-2.amazonaws.com/cobstatic.com/brs.world/builds/ModernHouseThing9.brs"},{map:"Cloudy and Cobertos's Deathrun",author:{id:"xxx",name:"Cloudy8"},description:"Deathrun set in a jungle made for a custom Deathrun gamemode",url:"https://s3.us-east-2.amazonaws.com/cobstatic.com/brs.world/builds/cloudysDeathrunRevivedv8.brs"},{map:"Mini Challenge",author:{id:"xxx",name:"Cobertos"},description:"A tiny parkour challenge",url:"https://s3.us-east-2.amazonaws.com/cobstatic.com/brs.world/builds/myChallengeOnHatasServer.brs"},{map:"DONOTUSE Stress Test - 14 mil",author:{id:"xxx",name:"Kodi"},description:"Stress test",url:"https://s3.us-east-2.amazonaws.com/cobstatic.com/brs.world/builds/spam+1x1f.brs"}]}},computed:{brsInfoWState:function(){return this.brsInfoList.map((function(e){return j({selected:!1},e)}))}},methods:{onFileChange:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(n){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log(n),t=n.target.files[0],t){e.next=4;break}return e.abrupt("return");case 4:return this.file=u(t),console.log("Start file convert..."),e.next=8,t.arrayBuffer();case 8:this.brsBuff=e.sent;case 9:case"end":return e.stop()}}),e,this)})));function n(n){return e.apply(this,arguments)}return n}(),onEntryClick:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(n,t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log(n),"input"!==n.target.tagName){e.next=3;break}return e.abrupt("return");case 3:return this.brsInfoWState.forEach((function(e){return e.selected=!1})),t.selected=!0,console.log("Start download..."),e.next=8,fetch(t.url);case 8:return r=e.sent,e.next=11,r.arrayBuffer();case 11:this.brsBuff=e.sent;case 12:case"end":return e.stop()}}),e,this)})));function n(n,t){return e.apply(this,arguments)}return n}(),stopInteracting:function(){var e=this;setTimeout((function(){return e.interacting=!1}),500)},openFileUploader:function(){this.$refs.fileUpload.click()}}},E=k,I=(t("0ab4"),Object(O["a"])(E,o,s,!1,null,null,null)),D=I.exports,P={name:"app",components:{BRSUI:D}},L=P,N=(t("5c0b"),Object(O["a"])(L,a,i,!1,null,null,null)),z=N.exports;r["a"].config.productionTip=!1,r["a"].config.errorHandler=console.error,new r["a"]({render:function(e){return e(z)}}).$mount("#app")},"5b3a":function(e,n,t){},"5c0b":function(e,n,t){"use strict";var r=t("e332"),a=t.n(r);a.a},e332:function(e,n,t){}});
//# sourceMappingURL=app.1f9f3f5c.js.map