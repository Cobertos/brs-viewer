{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/BRSUI.vue?12c4","webpack:///./src/components/BRSViewer.vue?84cc","webpack:///./src/App.vue?164e","webpack:///./src/components/BRSUI.vue?fba5","webpack:///./src/utils.js","webpack:///./src/components/BRSViewer.vue?fa7d","webpack:///./src/InstancedStandardMaterial.js","webpack:///./src/BRSMesh.js","webpack:///./src/BRSViewerScene.js","webpack:///src/components/BRSViewer.vue","webpack:///./src/components/BRSViewer.vue?1f05","webpack:///./src/components/BRSViewer.vue","webpack:///src/components/BRSUI.vue","webpack:///./src/components/BRSUI.vue?5233","webpack:///./src/components/BRSUI.vue","webpack:///src/App.vue","webpack:///./src/App.vue?1160","webpack:///./src/App.vue","webpack:///./src/main.js","webpack:///./src/App.vue?165b"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","staticRenderFns","staticClass","brsBuff","on","$event","onFileChange","_l","brsInfo","url","onEntryClick","_v","_s","map","author","description","noObserve","obj","keys","forEach","configurable","ref","InstancedStandardMaterial","shader","renderer","vertexShader","fragmentShader","THREE","BRSMesh","brsjsData","_buildResources","geo","mat","brs","arrayBuffer","console","log","BRS","read","baseGeo","attributes","uv","array","brickWidth","instancePositions","instanceQuaternions","instanceScales","instanceColors","bricks","br","idx","visibility","pos","position","axes","rots","Math","PI","quat","setFromAxisAngle","direction","rotation","scale","size","color","Array","isArray","colors","x","y","z","w","instancedGeometry","index","addAttribute","Float32Array","instancedMaterial","vertexColors","flatShading","undefined","load","tex","wrapS","wrapT","BRSViewerScene","am_light","add","dir_light","set","target","castShadow","shadow","camera","left","top","right","bottom","near","far","bias","mapSize","width","height","light","groundMat","groundPlaneSize","groundPlane","geometry","getAttribute","needsUpdate","quaternion","frustumCulled","fog","props","ArrayBuffer","mounted","canvas","$refs","antialias","logarithmicDepthBuffer","setClearColor","setSize","rect","cam","watch","methods","render","component","components","BRSViewer","brsInfoList","BRSUI","Vue","config","productionTip","errorHandler","error","h","App","$mount"],"mappings":"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","file":"js/app.2e8d9d3d.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BRSUI.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BRSUI.vue?vue&type=style&index=0&lang=scss&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BRSViewer.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BRSViewer.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('BRSUI')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"brs-container\"},[_c('BRSViewer',{attrs:{\"brsBuff\":_vm.brsBuff}}),_c('div',{staticClass:\"brs-main\"},[_c('div',{staticClass:\"brs-list\"},[_c('div',{staticClass:\"brs-list-item\"},[_c('input',{attrs:{\"type\":\"file\"},on:{\"change\":function($event){return _vm.onFileChange($event)}}})]),_vm._l((_vm.brsInfoList),function(brsInfo){return _c('div',{key:brsInfo.url,staticClass:\"brs-list-item\",on:{\"click\":function($event){return _vm.onEntryClick($event, brsInfo.url)}}},[_c('h2',[_vm._v(_vm._s(brsInfo.map))]),_c('p',[_vm._v(_vm._s(brsInfo.author.name))]),_c('p',[_vm._v(_vm._s(brsInfo.description))])])})],2)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export function noObserve(obj) {\r\n  //Mark all the properties as non-configurable and Vue won't iterate over them\r\n  //and make them all observable\r\n  Object.keys(obj).forEach((key)=>{\r\n    Object.defineProperty(obj, key, { configurable: false });\r\n  });\r\n  return obj;\r\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('canvas',{ref:\"renderer\"},[_vm._v(\"No WebGL Boi\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import * as THREE from \"three\";\r\n\r\n//You will have to make sure that you're using flatShading: true in the material\r\n//otherwise no lighting will show up. Normals just don't work right without\r\n//using the calculus version of the normals\r\n//BRSerker does a similar sort of thing, except manually\r\nexport class InstancedStandardMaterial extends THREE.MeshStandardMaterial {\r\n      onBeforeCompile(shader, renderer){\r\n        //Copy pasta of \r\n        //https://github.com/mrdoob/three.js/blob/master/src/renderers/shaders/ShaderLib/meshstandard_vert.glsl.js\r\n        //with some added stuff to take in an instancePosition, instanceQuaternion, etc...\r\n        shader.vertexShader =`\r\n#define STANDARD\r\n#define USE_UV\r\nvarying vec3 vViewPosition;\r\n#ifndef FLAT_SHADED\r\n  varying vec3 vNormal;\r\n  #ifdef USE_TANGENT\r\n    varying vec3 vTangent;\r\n    varying vec3 vBitangent;\r\n  #endif\r\n#endif\r\n#include <common>\r\n#include <uv_pars_vertex>\r\n#include <uv2_pars_vertex>\r\n#include <displacementmap_pars_vertex>\r\n#include <color_pars_vertex>\r\n#include <fog_pars_vertex>\r\n#include <morphtarget_pars_vertex>\r\n#include <skinning_pars_vertex>\r\n#include <shadowmap_pars_vertex>\r\n#include <logdepthbuf_pars_vertex>\r\n#include <clipping_planes_pars_vertex>\r\n\r\n// === INSTANCED ===\r\nvec3 applyTRS( vec3 position, vec3 translation, vec4 quaternion, vec3 scale ) {\r\n  position *= scale;\r\n  position += 2.0 * cross( quaternion.xyz, cross( quaternion.xyz, position ) + quaternion.w * position );\r\n  return position + translation;\r\n}\r\nattribute vec3 instancePosition;\r\nattribute vec4 instanceQuaternion;\r\nattribute vec3 instanceScale;\r\nattribute vec3 instanceColor;\r\n\r\nvoid main() {\r\n  #include <uv_vertex>\r\n  vUv *= vec2(10.0, 10.0);\r\n  #include <uv2_vertex>\r\n  #include <color_vertex>\r\n  // === INSTANCED (color) ===\r\n  #ifdef USE_COLOR\r\n    vColor.xyz = instanceColor.xyz;\r\n  #endif\r\n  #include <beginnormal_vertex>\r\n  #include <morphnormal_vertex>\r\n  #include <skinbase_vertex>\r\n  #include <skinnormal_vertex>\r\n  #include <defaultnormal_vertex>\r\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\r\n  vNormal = normalize( transformedNormal );\r\n  #ifdef USE_TANGENT\r\n    vTangent = normalize( transformedTangent );\r\n    vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\r\n  #endif\r\n#endif\r\n  #include <begin_vertex>\r\n  // === INSTANCED (position) ===\r\n  transformed = applyTRS( transformed, instancePosition, instanceQuaternion, instanceScale );\r\n\r\n  #include <morphtarget_vertex>\r\n  #include <skinning_vertex>\r\n  #include <displacementmap_vertex>\r\n  #include <project_vertex>\r\n  #include <logdepthbuf_vertex>\r\n  #include <clipping_planes_vertex>\r\n  vViewPosition = - mvPosition.xyz;\r\n  #include <worldpos_vertex>\r\n  #include <shadowmap_vertex>\r\n  #include <fog_vertex>\r\n  //vColor = instanceColor;//color;\r\n}\r\n        `;\r\n        shader.fragmentShader = `\r\n#define STANDARD\r\n#ifdef PHYSICAL\r\n  #define REFLECTIVITY\r\n  #define CLEARCOAT\r\n  #define TRANSPARENCY\r\n#endif\r\nuniform vec3 diffuse;\r\nuniform vec3 emissive;\r\nuniform float roughness;\r\nuniform float metalness;\r\nuniform float opacity;\r\n#ifdef TRANSPARENCY\r\n  uniform float transparency;\r\n#endif\r\n#ifdef REFLECTIVITY\r\n  uniform float reflectivity;\r\n#endif\r\n#ifdef CLEARCOAT\r\n  uniform float clearcoat;\r\n  uniform float clearcoatRoughness;\r\n#endif\r\n#ifdef USE_SHEEN\r\n  uniform vec3 sheen;\r\n#endif\r\nvarying vec3 vViewPosition;\r\n#ifndef FLAT_SHADED\r\n  varying vec3 vNormal;\r\n  #ifdef USE_TANGENT\r\n    varying vec3 vTangent;\r\n    varying vec3 vBitangent;\r\n  #endif\r\n#endif\r\n#include <common>\r\n#include <packing>\r\n#include <dithering_pars_fragment>\r\n#include <color_pars_fragment>\r\n#include <uv_pars_fragment>\r\n#include <uv2_pars_fragment>\r\n#include <map_pars_fragment>\r\n#include <alphamap_pars_fragment>\r\n#include <aomap_pars_fragment>\r\n#include <lightmap_pars_fragment>\r\n#include <emissivemap_pars_fragment>\r\n#include <bsdfs>\r\n#include <cube_uv_reflection_fragment>\r\n#include <envmap_common_pars_fragment>\r\n#include <envmap_physical_pars_fragment>\r\n#include <fog_pars_fragment>\r\n#include <lights_pars_begin>\r\n#include <lights_physical_pars_fragment>\r\n#include <shadowmap_pars_fragment>\r\n#include <bumpmap_pars_fragment>\r\n#include <normalmap_pars_fragment>\r\n#include <clearcoat_normalmap_pars_fragment>\r\n#include <roughnessmap_pars_fragment>\r\n#include <metalnessmap_pars_fragment>\r\n#include <logdepthbuf_pars_fragment>\r\n#include <clipping_planes_pars_fragment>\r\n\r\n// === MINE ===\r\n//varying vec3 vColor;\r\n\r\nvoid main() {\r\n  #include <clipping_planes_fragment>\r\n  vec4 diffuseColor = vec4( diffuse, opacity );\r\n  ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\r\n  vec3 totalEmissiveRadiance = emissive;\r\n  #include <logdepthbuf_fragment>\r\n  #include <map_fragment>\r\n  #include <color_fragment>\r\n  //diffuseColor.rgb = vColor;\r\n  #include <alphamap_fragment>\r\n  #include <alphatest_fragment>\r\n  #include <roughnessmap_fragment>\r\n  #include <metalnessmap_fragment>\r\n  #include <normal_fragment_begin>\r\n\r\n  #include <normal_fragment_maps>\r\n  #include <clearcoat_normal_fragment_begin>\r\n  #include <clearcoat_normal_fragment_maps>\r\n  #include <emissivemap_fragment>\r\n  // accumulation\r\n  #include <lights_physical_fragment>\r\n  #include <lights_fragment_begin>\r\n  #include <lights_fragment_maps>\r\n  #include <lights_fragment_end>\r\n  // modulation\r\n  #include <aomap_fragment>\r\n  vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\r\n  // this is a stub for the transparency model\r\n  #ifdef TRANSPARENCY\r\n    diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\r\n  #endif\r\n  gl_FragColor = vec4( outgoingLight, diffuseColor.a );\r\n  #include <tonemapping_fragment>\r\n  #include <encodings_fragment>\r\n  #include <fog_fragment>\r\n  #include <premultiplied_alpha_fragment>\r\n  #include <dithering_fragment>\r\n}\r\n        `;\r\n      }\r\n    }","import brs from \"brs-js\";\r\nimport * as THREE from \"three\";\r\nimport { InstancedStandardMaterial } from \"./InstancedStandardMaterial\";\r\n\r\nexport class BRSMesh extends THREE.Mesh {\r\n  /**Returns the THREE.js units of one stud on a 1x1x1 brick so we can work with everything\r\n   * just as it exists in the BRS file and hopefully for how Brickadia sees it should we want\r\n   * to do more advanced measurements.\r\n   * NOTE: that when loaded from a BRS, a 1x1x1 will have a 5x5x6 .size property and a 1x1x1F will\r\n   * have a 5x5x2 .size property but when aligning with .position, everything is off. It seems Brickadia\r\n   * applies the 5x5x6 size to a 2x2x2 sized mesh (because it's 1 unit from center) so we need to multiply\r\n   * this by 2 when using BoxBufferGeometry as that is a 1x1x1 size mesh (0.5 unit from center).\r\n   * @returns {Number} The width of one brick\r\n   */\r\n  static brickWidth() {\r\n    return 5*2;\r\n  }\r\n\r\n  constructor(brsjsData) {\r\n    let [geo, mat] = BRSMesh._buildResources(brsjsData);\r\n    super(geo, mat);\r\n    //TODO: We should release the reference to this as some point\r\n    //so that we don't have large chunks of memory we don't need\r\n    //for large builds\r\n    this.brs = brsjsData;\r\n  }\r\n\r\n  static fromBuffer(arrayBuffer) {\r\n    console.log(\"Start parse...\");\r\n    let brsjsData = BRS.read(arrayBuffer);\r\n    return new BRSMesh(brsjsData);\r\n  }\r\n\r\n  static _buildResources(brs) {\r\n    //Mesh workflow (NOT PERFORMANT FOR LARGE BUILDS!)\r\n    /*\r\n    brs.colors = brs.colors.map((arr)=>{\r\n      return new THREE.Color(arr[0] / 255, arr[1] / 255, arr[2] / 255);\r\n    });\r\n    brs.materials = brs.colors.map((color)=>new THREE.MeshBasicMaterial({ color }));\r\n    brs.bricks = brs.bricks.map((br,idx)=>{\r\n      let geo = new THREE.BoxBufferGeometry(1,1,1);\r\n      let mat = brs.materials[br.color];\r\n      let mesh = new THREE.Mesh(geo, mat);\r\n      mesh.position.set(br.position[0], br.position[2], br.position[1]);\r\n      mesh.scale.set(100,100,100);\r\n      return mesh;\r\n    });*/\r\n    \r\n    //Instanced Mesh Workflow\r\n    let baseGeo = new THREE.BoxBufferGeometry(1,1,1);\r\n    baseGeo.attributes.uv.array = baseGeo.attributes.uv.array.map((i)=>i/BRSMesh.brickWidth());\r\n    let color = new THREE.Color(1,1,1);\r\n    let buffGeo = new THREE.BufferGeometry();\r\n    let instancePositions = [];\r\n    let instanceQuaternions = [];\r\n    let instanceScales = []\r\n    let instanceColors = [];\r\n    console.log(\"Starting load...\")\r\n    brs.bricks.forEach((br, idx)=>{\r\n      if(idx % 1000 === 0) {\r\n        console.log(`Brick ${idx}`);\r\n      }\r\n      if(!br.visibility) {\r\n        //TODO: Put this in a list of meshs to render as wireframes\r\n        return; //Don't render invisibles\r\n      }\r\n\r\n      let pos = new THREE.Vector3(br.position[0], br.position[2], br.position[1]);\r\n      const axes = [\r\n        new THREE.Vector3(1,0,0),  //Brickadia +X => THREE.js +X\r\n        new THREE.Vector3(-1,0,0), //Brickadia -X => THREE.js -X\r\n        new THREE.Vector3(0,0,1),  //Brickadia +Y => THREE.js +Z\r\n        new THREE.Vector3(0,0,-1), //Brickadia -Y => THREE.js -Z\r\n        new THREE.Vector3(0,1,0),  //Brickadia +Z => THREE.js +Y\r\n        new THREE.Vector3(0,-1,0), //Brickadia -Z => THREE.js -Y\r\n      ];\r\n      const rots = [\r\n        0,\r\n        Math.PI/2,\r\n        Math.PI,\r\n        3*Math.PI/2\r\n      ];\r\n      let quat = new THREE.Quaternion().setFromAxisAngle(axes[br.direction], rots[br.rotation]);\r\n\r\n      //A 1x1F is 5,5,2 size, seemingly meaning it's 10x10x4 units wide when playing around in game\r\n      //A 1x1 is 5,5,6, seemingly 10x10x12\r\n      //Because our cube is 1x1x1, we need to multiple size to get the correct scale\r\n      let scale = new THREE.Vector3(br.size[0]*2, br.size[2]*2, br.size[1]*2);\r\n      let color = Array.isArray(br.color) ? new THREE.Color(br.color[0]/255, br.color[1]/255, br.color[2]/255) :\r\n        brs.colors[br.color];\r\n      \r\n      instancePositions.push( pos.x, pos.y, pos.z );\r\n      instanceQuaternions.push( quat.x, quat.y, quat.z, quat.w );\r\n      instanceScales.push( scale.x, scale.y, scale.z );\r\n      instanceColors.push( color[0]/255, color[1]/255, color[2]/255 );\r\n    });\r\n    \r\n    let instancedGeometry = new THREE.InstancedBufferGeometry();\r\n    instancedGeometry.index = baseGeo.index;\r\n    instancedGeometry.attributes.position = baseGeo.attributes.position;\r\n    //instancedGeometry.attributes.color = baseGeo.attributes.color;\r\n    instancedGeometry.addAttribute( 'instancePosition', new THREE.InstancedBufferAttribute( new Float32Array( instancePositions ), 3 ) );\r\n    instancedGeometry.addAttribute( 'instanceQuaternion', new THREE.InstancedBufferAttribute( new Float32Array( instanceQuaternions ), 4 ) );\r\n    instancedGeometry.addAttribute( 'instanceScale', new THREE.InstancedBufferAttribute( new Float32Array( instanceScales ), 3 ) );\r\n    instancedGeometry.addAttribute( 'instanceColor', new THREE.InstancedBufferAttribute( new Float32Array( instanceColors ), 3 ) );\r\n\r\n    let instancedMaterial = new InstancedStandardMaterial({\r\n      vertexColors: THREE.VertexColors,\r\n      flatShading: true,\r\n      map: undefined\r\n    });\r\n    new THREE.TextureLoader().load(\"brickTOP.png\",(tex)=>{\r\n        tex.wrapS = THREE.RepeatWrapping;\r\n        tex.wrapT = THREE.RepeatWrapping;\r\n        //tex.anisotopy = 8;\r\n        //instancedMaterial.map = tex;\r\n        //instancedMaterial.needsUpdate = true;\r\n    });\r\n\r\n    // instantiate a loader\r\n    \r\n\r\n    return [instancedGeometry, instancedMaterial];\r\n  }\r\n}\r\n\r\n\r\n\r\n","import * as THREE from 'three';\r\nimport { BRSMesh } from './BRSMesh.js';\r\n\r\n/**Scene that holds the BRSMesh and all other default lighting\r\n * and objects\r\n */\r\nexport class BRSViewerScene extends THREE.Scene {\r\n    constructor(){\r\n        super();\r\n        //Load the assets\r\n        //let envMapPath = 'https://cdn.rawgit.com/mrdoob/three.js/dev/examples/textures/cube/SwedishRoyalCastle/';\r\n        //let envUrls = [\"px\", \"nx\", \"py\", \"ny\", \"pz\", \"nz\"].map((str)=>`${envMapPath}${str}.jpg`)\r\n        //let env = await promisify(new THREE.CubeTextureLoader().load(urls));\r\n        //env.format = THREE.RGBFormat;\r\n\r\n        //Lighting\r\n        // ambient light\r\n        let am_light = new THREE.AmbientLight( 0xBBBBBB );\r\n        this.add( am_light );\r\n        // directional light\r\n        let dir_light = new THREE.DirectionalLight( 0xFFFFFF );\r\n        dir_light.position.set( 20, 30, -5 );\r\n        dir_light.target.position.set(0,0,0);\r\n        dir_light.castShadow = true;\r\n        dir_light.shadow.camera.left = -30;\r\n        dir_light.shadow.camera.top = -30;\r\n        dir_light.shadow.camera.right = 30;\r\n        dir_light.shadow.camera.bottom = 30;\r\n        dir_light.shadow.camera.near = 20;\r\n        dir_light.shadow.camera.far = 200;\r\n        dir_light.shadow.bias = -.001\r\n        dir_light.shadow.mapSize.width = dir_light.shadow.mapSize.height = 2048;\r\n        this.add( dir_light );\r\n        //Point light\r\n        let light = new THREE.PointLight( 0xffffdd, 2, 2 );\r\n        light.position.set(0,3,-2);\r\n        this.add(light);\r\n\r\n        //Ground plane\r\n        new THREE.TextureLoader().load(\"brickgreen.png\",(tex)=>{\r\n            tex.wrapS = THREE.RepeatWrapping;\r\n            tex.wrapT = THREE.RepeatWrapping;\r\n            //tex.anisotopy = 8;\r\n            groundMat.map = tex;\r\n        });\r\n        const groundMat = new THREE.MeshStandardMaterial( {\r\n            color: 0x00aa00,\r\n            map: undefined\r\n        } );\r\n        const groundPlaneSize = 100000;\r\n        let groundPlane = new THREE.Mesh(\r\n            new THREE.PlaneBufferGeometry( groundPlaneSize, groundPlaneSize ),\r\n            groundMat\r\n            );\r\n        let uv = groundPlane.geometry.getAttribute( 'uv' );\r\n        console.log(uv);\r\n        uv.array = uv.array.map((i)=>i*groundPlaneSize/BRSMesh.brickWidth());\r\n        uv.needsUpdate = true;\r\n        groundPlane.quaternion.setFromAxisAngle(new THREE.Vector3(1,0,0), -Math.PI/2);\r\n        groundPlane.frustumCulled = false;\r\n        this.add(groundPlane);\r\n\r\n        this.fog = new THREE.FogExp2( 0x9999FF, 0.000025 );\r\n    }\r\n}","<template>\r\n  <canvas ref=\"renderer\">No WebGL Boi</canvas>\r\n</template>\r\n\r\n<script>\r\nimport * as THREE from 'three';\r\nimport { MapControls } from 'three/examples/jsm/controls/OrbitControls.js';\r\nimport { BRSMesh } from '../BRSMesh.js';\r\nimport { BRSViewerScene } from '../BRSViewerScene.js';\r\nimport { noObserve } from '../utils.js';\r\n\r\nexport default {\r\n  name: 'BRSViewer',\r\n  props: {\r\n    brsBuff: ArrayBuffer\r\n  },\r\n  data(){ \r\n    return {\r\n        renderer: undefined,\r\n        scene: noObserve(new BRSViewerScene()),\r\n        cam: noObserve(new THREE.PerspectiveCamera( 75, 1, 1, 80000 )),\r\n        buildBounds: undefined,\r\n        rafID: undefined\r\n    }\r\n  },\r\n  mounted(){\r\n    //Setup the renderer\r\n    this.renderer = noObserve(new THREE.WebGLRenderer({\r\n      canvas: this.$refs.renderer,\r\n      antialias: true,\r\n      logarithmicDepthBuffer: true\r\n    }));\r\n    this.renderer.setClearColor(new THREE.Color(0x9999FF));\r\n    let rect = this.$refs.renderer.getBoundingClientRect();\r\n    this.renderer.setSize(rect.width, rect.height);\r\n\r\n    //Setup the camera\r\n    this.cam.position.set(0,10,0);\r\n\r\n    //Controls\r\n    //let controls = new MapControls( this.cam, this.renderer.domElement );\r\n    //controls.addEventListener( 'change', render ); // call this only in static scenes (i.e., if there is no animation loop)\r\n    //controls.enableDamping = true; // an animation loop is required when either damping or auto-rotation are enabled\r\n    //controls.dampingFactor = 0.05;\r\n    //controls.screenSpacePanning = false;\r\n    //controls.minDistance = 100;\r\n    //controls.maxDistance = 500;\r\n    //controls.maxPolarAngle = Math.PI / 2;\r\n  },\r\n  watch: {\r\n    async brsBuff(){\r\n        if(!this.brsBuff) {\r\n            return;\r\n        }\r\n        //Teardown old stuff\r\n        window.cancelAnimationFrame(this.rafID);\r\n        this.scene.remove(...this.scene.children.filter((obj)=>obj instanceof BRSMesh));\r\n\r\n        //Generate the new BRSMesh and add it\r\n        /*const tex = await new Promise((resolve, reject) => {\r\n            new THREE.TextureLoader()\r\n              .load( 'https://rawcdn.githack.com/mrdoob/three.js/7e0a78beb9317e580d7fa4da9b5b12be051c6feb/examples/textures/uv_grid_opengl.jpg', resolve, undefined, reject );\r\n          });*/\r\n        let mesh = BRSMesh.fromBuffer(this.brsBuff);\r\n        mesh.frustumCulled = false;\r\n        this.scene.add( mesh );\r\n        \r\n        //Do some calculations for the new camera path\r\n        //Find the center of gravity of all the bricks (the average vs the center of bounding box)\r\n        let positions = mesh.brs.bricks\r\n          .map((br)=>{\r\n            if(!br.visibility) { //TODO: Move into BRSMesh, these transformations shouldn't be out here\r\n              return undefined;\r\n            }\r\n            return new THREE.Vector3(br.position[0], br.position[2], br.position[1]);\r\n          })\r\n          .filter((vec)=>!!vec);\r\n        let centerOfGravity = positions.reduce((acc, vec)=>acc.add(vec), new THREE.Vector3(0,0,0))\r\n          .multiplyScalar(1/positions.length);\r\n        //Find the mean and standard deviation from the centerOfGravity\r\n        let distances = positions.map((vec)=>vec.distanceTo(centerOfGravity));\r\n        let meanDistance = distances.reduce((a,d)=>a+d,0) / positions.length;\r\n        let varianceSum = distances.reduce((a,d)=>a + Math.pow(Math.abs(d - meanDistance), 2), 0);\r\n        let stdDevDistance = Math.sqrt(varianceSum / positions.length);\r\n\r\n        //Compute the final camera bounding box discarding outliers\r\n        let outliers = 0;\r\n        this.buildBounds = noObserve(new THREE.Box3());\r\n        mesh.brs.bricks.forEach((br)=>{\r\n          let distance = new THREE.Vector3(br.position[0], br.position[2], br.position[1]).distanceTo(centerOfGravity);\r\n          if(distance > meanDistance + stdDevDistance * 3 || distance < meanDistance - stdDevDistance * 3) {\r\n            console.log(`Removed outlier at Brickadia position ${br.position} ${distance}`);\r\n            outliers++;\r\n            return;\r\n          }\r\n          this.buildBounds.expandByPoint(new THREE.Vector3(br.position[0], br.position[2], br.position[1]));\r\n        });\r\n        console.log(`Center: ${centerOfGravity.x} ${centerOfGravity.y} ${centerOfGravity.z}`);\r\n        console.log(`Mean: ${meanDistance}`);\r\n        console.log(`StdD: ${stdDevDistance}`);\r\n        console.log(`Outl: ${outliers}`);\r\n        console.log(`BrickCount: ${positions.length}`);\r\n        console.log(this.buildBounds);\r\n        this.rafID = window.requestAnimationFrame(this.render.bind(this));\r\n    }\r\n  },\r\n  methods:{\r\n    render(){\r\n        this.rafID = window.requestAnimationFrame(this.render.bind(this));\r\n        //look in a circle over the whole map after it loads\r\n        let theta = Date.now() / 1000 /30 * Math.PI * 2;\r\n        let x = Math.sin(theta);\r\n        let z = Math.cos(theta);\r\n        let center = this.buildBounds.getCenter(new THREE.Vector3());\r\n        let exts = this.buildBounds.getSize(new THREE.Vector3()).multiplyScalar(0.5);\r\n        this.cam.position.copy(center);\r\n        this.cam.position.add(new THREE.Vector3(exts.x * 1.5 * x, exts.y * 2, exts.z * 1.5 * z));\r\n        this.cam.lookAt(center.clone().add(new THREE.Vector3(exts.x * x, 0, exts.z * z)));\r\n        this.renderer.render(this.scene, this.cam);\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\ncanvas {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100vw;\r\n  height: 100vh;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BRSViewer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BRSViewer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./BRSViewer.vue?vue&type=template&id=62ef9510&\"\nimport script from \"./BRSViewer.vue?vue&type=script&lang=js&\"\nexport * from \"./BRSViewer.vue?vue&type=script&lang=js&\"\nimport style0 from \"./BRSViewer.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"brs-container\">\r\n    <BRSViewer :brsBuff=\"brsBuff\" />\r\n    <div class=\"brs-main\">\r\n      <div class=\"brs-list\">\r\n        <div class=\"brs-list-item\">\r\n          <input type=\"file\"\r\n            @change=\"onFileChange($event)\" />\r\n        </div>\r\n        <div class=\"brs-list-item\"\r\n          v-for=\"brsInfo in brsInfoList\"\r\n          :key=\"brsInfo.url\"\r\n          @click=\"onEntryClick($event, brsInfo.url)\">\r\n          <h2>{{brsInfo.map}}</h2>\r\n          <p>{{brsInfo.author.name}}</p>\r\n          <p>{{brsInfo.description}}</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { noObserve } from '../utils.js';\r\nimport BRSViewer from './BRSViewer.vue';\r\n\r\nexport default {\r\n  name: 'BRSUI',\r\n  components: {\r\n    BRSViewer\r\n  },\r\n  data(){ \r\n    return {\r\n      brsBuff: undefined,\r\n      brsInfoList: [{\r\n        map: \"Bowling Alley\",\r\n        author: {id: \"xxx\", name: \"Cobertos\"},\r\n        description: \"Bowling alley I made a long time back but it held up pretty well\",\r\n        url: \"https://s3.us-east-2.amazonaws.com/brs.world/builds/BowlingAlleyUpdatev0.3.brs\"\r\n        //save_time: UTC as 8 bytes,\r\n        //brick_count: int,\r\n      },{\r\n        map: \"Balloonist's Build Royale\",\r\n        author: {id: \"xxx\", name: \"Cobertos\"},\r\n        description: \"Islands featured in the Blockland trailer for an unfinished gamemode\",\r\n        url: \"https://s3.us-east-2.amazonaws.com/brs.world/builds/BBRMinimal8.brs\"\r\n        //save_time: UTC as 8 bytes,\r\n        //brick_count: int,\r\n      },{\r\n        map: \"de_cbble2\",\r\n        author: {id: \"xxx\", name: \"Cobertos\"},\r\n        description: \"Half of de_cbble2 from Counter Strike 1.6\",\r\n        url: \"https://s3.us-east-2.amazonaws.com/brs.world/builds/de_cbble2.brs\"\r\n        //save_time: UTC as 8 bytes,\r\n        //brick_count: int,\r\n      },{\r\n        map: \"Escher\",\r\n        author: {id: \"xxx\", name: \"Cobertos\"},\r\n        description: \"Escher-esque staircases\",\r\n        url: \"https://s3.us-east-2.amazonaws.com/brs.world/builds/escher4.brs\"\r\n        //save_time: UTC as 8 bytes,\r\n        //brick_count: int,\r\n      },{\r\n        map: \"Feel Good Inc Island\",\r\n        author: {id: \"xxx\", name: \"Cobertos\"},\r\n        description: \"The floating windmill island from the Gorillaz song Feel Good Inc\",\r\n        url: \"https://s3.us-east-2.amazonaws.com/brs.world/builds/FloatingIslandFINAL.brs\"\r\n        //save_time: UTC as 8 bytes,\r\n        //brick_count: int,\r\n      },{\r\n        map: \"Modern House\",\r\n        author: {id: \"xxx\", name: \"Cobertos\"},\r\n        description: \"A modern house with some secret bat cave like thing.\",\r\n        url: \"https://s3.us-east-2.amazonaws.com/brs.world/builds/ModernHouseThing9.brs\"\r\n        //save_time: UTC as 8 bytes,\r\n        //brick_count: int,\r\n      },{\r\n        map: \"Cloudy and Cobertos's Deathrun\",\r\n        author: {id: \"xxx\", name: \"Cloudy8\"},\r\n        description: \"Deathrun set in a jungle made for a custom Deathrun gamemode\",\r\n        url: \"https://s3.us-east-2.amazonaws.com/brs.world/builds/cloudysDeathrunRevivedv8.brs\"\r\n      },{\r\n        map: \"Mini Challenge\",\r\n        author: {id: \"xxx\", name: \"Cobertos\"},\r\n        description: \"A tiny parkour challenge\",\r\n        url: \"https://s3.us-east-2.amazonaws.com/brs.world/builds/myChallengeOnHatasServer.brs\"\r\n        //save_time: UTC as 8 bytes,\r\n        //brick_count: int,\r\n      },{\r\n        map: \"Valley TDM\",\r\n        author: {id: \"xxx\", name: \"Cobertos\"},\r\n        description: \"A large TDM set in a valley with may interactable elements and easter eggs\",\r\n        url: \"https://s3.us-east-2.amazonaws.com/brs.world/builds/ValleyTDMFINALFINAL1.brs\"\r\n        //save_time: UTC as 8 bytes,\r\n        //brick_count: int,\r\n      }]\r\n    }\r\n  },\r\n  methods:{\r\n    async onFileChange(e){\r\n      console.log(e);\r\n      const file = e.target.files[0];\r\n      if(!file) {\r\n        return;\r\n      }\r\n      console.log(\"Start file convert...\");\r\n      this.brsBuff = await file.arrayBuffer();\r\n    },\r\n    async onEntryClick(e, url){\r\n      console.log(e);\r\n      if(e.target.tagName === \"input\") {\r\n        return;\r\n      }\r\n      //Load the BRSHMesh\r\n      console.log(\"Start download...\");\r\n      const brsObj = await fetch(url);\r\n      this.brsBuff = await brsObj.arrayBuffer();\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.brs-main {\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0;\r\n  height: 100vh;\r\n  overflow: auto;\r\n  width: 300px;\r\n  color: white;\r\n\r\n  .brs-list-item {\r\n    min-height: 80px;\r\n    text-align: left;\r\n    padding: 20px;\r\n\r\n\r\n    &:hover {\r\n      background-image: linear-gradient(to left, #FFFFFF 0%, #AAAAAA 100%)\r\n    }\r\n  }\r\n\r\n  //Scrollbar webkit\r\n  &::-webkit-scrollbar {\r\n      width: 12px;\r\n      height: 12px;\r\n\r\n      /*@include desktop {\r\n          width: 10px;\r\n          height: 10px;\r\n      }*/\r\n  }\r\n  &::-webkit-scrollbar-button {\r\n      display: none; //No up or down buttons\r\n  }\r\n  &::-webkit-scrollbar-thumb {\r\n      background-color: #AAAAAA;\r\n      border-radius: 9999px;\r\n      &:hover {\r\n          background-color: #FFFFFF;\r\n      }\r\n  }\r\n  &::-webkit-scrollbar-track {\r\n      display: none;\r\n  }\r\n  //Scrollbar IE and FF\r\n  scrollbar-color: #AAAAAA rgba(0,0,0,0); //thumb track\r\n  &:hover {\r\n      scrollbar-color: #FFFFFF rgba(0,0,0,0); //thumb track\r\n  }\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BRSUI.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BRSUI.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./BRSUI.vue?vue&type=template&id=c3208e9a&\"\nimport script from \"./BRSUI.vue?vue&type=script&lang=js&\"\nexport * from \"./BRSUI.vue?vue&type=script&lang=js&\"\nimport style0 from \"./BRSUI.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"app\">\n    <BRSUI />\n  </div>\n</template>\n\n<script>\nimport BRSUI from './components/BRSUI.vue'\n\nexport default {\n  name: 'app',\n  components: {\n    BRSUI\n  }\n}\n</script>\n\n<style lang=\"scss\">\n#app {\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  margin-top: 60px;\n}\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=6570a0c0&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import 'whatwg-fetch';\nimport Vue from 'vue'\nimport App from './App.vue'\n\nVue.config.productionTip = false\nVue.config.errorHandler = console.error;\n\nnew Vue({\n  render: h => h(App)\n}).$mount('#app')\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}